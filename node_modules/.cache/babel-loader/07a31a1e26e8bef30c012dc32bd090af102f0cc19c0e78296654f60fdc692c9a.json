{"ast":null,"code":"import React,{createContext,useContext,useState}from'react';// Define the context type\nimport{jsx as _jsx}from\"react/jsx-runtime\";// Create context\nconst AuthContext=/*#__PURE__*/createContext(undefined);// Provider component\nexport const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(()=>{const storedUser=localStorage.getItem('user');return storedUser?JSON.parse(storedUser):null;});const login=async credentials=>{const response=await fetch('http://leadinfo.site/employee/login.php',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(credentials)});const json=await response.json();if(!response.ok||!json.success){throw new Error(json.message||'Login failed');}// Save user and token to localStorage\nlocalStorage.setItem('user',JSON.stringify(json.data));// localStorage.setItem('token', json.token);\nsetUser(json.data);// Update context\n};const logout=()=>{localStorage.removeItem('user');setUser(null);window.location.href='/CRM';// Optional: Redirect after logout\n};const isAuthenticated=!!user;return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{login,logout,isAuthenticated,user},children:children});};// Hook to use AuthContext\nexport const useAuth=()=>{const context=useContext(AuthContext);if(!context)throw new Error('useAuth must be used within AuthProvider');return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","user","setUser","storedUser","localStorage","getItem","JSON","parse","login","credentials","response","fetch","method","headers","body","stringify","json","ok","success","Error","message","setItem","data","logout","removeItem","window","location","href","isAuthenticated","Provider","value","useAuth","context"],"sources":["C:/Users/Admin/AVA-/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { LoginCredentials, User } from '../types';\r\n\r\n// Define the context type\r\ninterface AuthContextType {\r\n  login: (credentials: LoginCredentials) => Promise<void>;\r\n  logout: () => void;\r\n  isAuthenticated: boolean;\r\n  user: User | null;\r\n}\r\n\r\n// Create context\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\n// Provider component\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const [user, setUser] = useState<User | null>(() => {\r\n    const storedUser = localStorage.getItem('user');\r\n    return storedUser ? JSON.parse(storedUser) : null;\r\n  });\r\n\r\n  const login = async (credentials: LoginCredentials) => {\r\n    const response = await fetch('http://leadinfo.site/employee/login.php', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(credentials),\r\n    });\r\n\r\n    const json = await response.json();\r\n\r\n    if (!response.ok || !json.success) {\r\n      throw new Error(json.message || 'Login failed');\r\n    }\r\n\r\n    // Save user and token to localStorage\r\n    localStorage.setItem('user', JSON.stringify(json.data));\r\n    // localStorage.setItem('token', json.token);\r\n    \r\n    setUser(json.data); // Update context\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('user');\r\n    setUser(null);\r\n    window.location.href = '/CRM'; // Optional: Redirect after logout\r\n  };\r\n\r\n  const isAuthenticated = !!user;\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ login, logout, isAuthenticated, user }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\n// Hook to use AuthContext\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) throw new Error('useAuth must be used within AuthProvider');\r\n  return context;\r\n};\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,KAAmB,OAAO,CAG7E;AAAA,OAAAC,GAAA,IAAAC,IAAA,yBAQA;AACA,KAAM,CAAAC,WAAW,cAAGL,aAAa,CAA8BM,SAAS,CAAC,CAEzE;AACA,MAAO,MAAM,CAAAC,YAAqD,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAChF,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGT,QAAQ,CAAc,IAAM,CAClD,KAAM,CAAAU,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC/C,MAAO,CAAAF,UAAU,CAAGG,IAAI,CAACC,KAAK,CAACJ,UAAU,CAAC,CAAG,IAAI,CACnD,CAAC,CAAC,CAEF,KAAM,CAAAK,KAAK,CAAG,KAAO,CAAAC,WAA6B,EAAK,CACrD,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,yCAAyC,CAAE,CACtEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAER,IAAI,CAACS,SAAS,CAACN,WAAW,CAClC,CAAC,CAAC,CAEF,KAAM,CAAAO,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAACM,IAAI,CAAC,CAAC,CAElC,GAAI,CAACN,QAAQ,CAACO,EAAE,EAAI,CAACD,IAAI,CAACE,OAAO,CAAE,CACjC,KAAM,IAAI,CAAAC,KAAK,CAACH,IAAI,CAACI,OAAO,EAAI,cAAc,CAAC,CACjD,CAEA;AACAhB,YAAY,CAACiB,OAAO,CAAC,MAAM,CAAEf,IAAI,CAACS,SAAS,CAACC,IAAI,CAACM,IAAI,CAAC,CAAC,CACvD;AAEApB,OAAO,CAACc,IAAI,CAACM,IAAI,CAAC,CAAE;AACtB,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CACnBnB,YAAY,CAACoB,UAAU,CAAC,MAAM,CAAC,CAC/BtB,OAAO,CAAC,IAAI,CAAC,CACbuB,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,MAAM,CAAE;AACjC,CAAC,CAED,KAAM,CAAAC,eAAe,CAAG,CAAC,CAAC3B,IAAI,CAE9B,mBACEN,IAAA,CAACC,WAAW,CAACiC,QAAQ,EAACC,KAAK,CAAE,CAAEtB,KAAK,CAAEe,MAAM,CAAEK,eAAe,CAAE3B,IAAK,CAAE,CAAAD,QAAA,CACnEA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED;AACA,MAAO,MAAM,CAAA+B,OAAO,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAAC,OAAO,CAAGxC,UAAU,CAACI,WAAW,CAAC,CACvC,GAAI,CAACoC,OAAO,CAAE,KAAM,IAAI,CAAAb,KAAK,CAAC,0CAA0C,CAAC,CACzE,MAAO,CAAAa,OAAO,CAChB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}